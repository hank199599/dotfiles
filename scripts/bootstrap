#!/usr/bin/env bash

source utils

export DOTFILES_DIR=$HOME/.dotfiles
info DOTFILES_DIR=$DOTFILES_DIR


# For temporary settings.
info PATH="$PATH:$DOTFILES_DIR/.bin" >> ~/.bash_profile
source ~/.bash_profile


# Install homebrew without sudo.
# @see https://docs.brew.sh/Installation
if [[ -z $(command -v brew) ]]; then
    mkdir -p $DOTFILES_DIR/.installed/homebrew && curl -L https://github.com/Homebrew/brew/tarball/master | tar xz --strip 1 -C $DOTFILES_DIR/.installed/homebrew
    chmod +x $DOTFILES_DIR/.installed/homebrew/bin/brew
    ln -sf $DOTFILES_DIR/.installed/homebrew/bin/brew $HOME/.dotfiles/.bin/brew
fi;

# If brew install failed then exit.
if [[ -z $(command -v brew) ]]; then
    fail "homebrew install failed"
fi;


# Install oh-my-zsh.
# @see https://ohmyz.sh/#install
[[ ! -d $HOME/.oh-my-zsh ]] && curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh | bash


# Install sdkman(java version management).
# @see https://sdkman.io/install
[[ -z $(command -v sdk) ]] && curl -s "https://get.sdkman.io" | bash

success "Bootstrap successful."
exit 0
